{% extends "base.html" %}

{% block title %}Dashboard - CampusDate{% endblock %}

{% block content %}
<div class="dashboard-grid"
    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">

    <!-- Welcome & Actions Card -->
    <div class="glass-card">
        <h2>Welcome, {{ user.full_name or user.email }}!</h2>
        <p>Ready to meet your campus soulmate?</p>

        <div style="margin-top: 1.5rem; display: flex; gap: 1rem; flex-wrap: wrap;">
            <a href="{{ url_for('profile.create') }}" class="btn-primary">
                Edit Profile
            </a>
            <a href="{{ url_for('dashboard.suggestions') }}" class="btn-primary"
                style="background: linear-gradient(45deg, #ff6b81, #ff4757);">
                Find Matches
            </a>
        </div>
    </div>

    <!-- Daily Quote Card -->
    <div class="glass-card" style="text-align: center;">
        <h3>Daily Love Quote</h3>
        <blockquote style="font-size: 1.2rem; font-style: italic; color: var(--text-primary); margin: 20px 0;">
            "{{ quote }}"
        </blockquote>
    </div>

    <!-- Relationship Importance Meter -->
    <div class="glass-card" style="text-align: center;">
        <h3>Today's Vibe Check</h3>
        <div
            style="width: 150px; height: 150px; border-radius: 50%; border: 10px solid #ff4757; display: flex; align-items: center; justify-content: center; margin: 0 auto; font-size: 2rem; font-weight: bold; color: #ff4757; box-shadow: 0 0 20px rgba(255, 71, 87, 0.3);">
            {{ relationship_importance }}%
        </div>
        <p style="margin-top: 10px;">Relationship Readiness</p>
    </div>

</div>

<!-- Confession Wall Section -->
<div style="margin-top: 4rem;">
    <h2 style="text-align: center; color: white; text-shadow: 0 2px 10px rgba(255, 71, 87, 0.5);">Anonymous Confession
        Wall</h2>
    <p style="text-align: center; color: var(--text-primary); margin-bottom: 2rem;">Confess your campus crush
        anonymously!</p>

    <!-- Submission Form -->
    <div class="glass-card" style="max-width: 600px; margin: 0 auto 3rem auto;">
        <form method="POST" action="{{ url_for('dashboard.home') }}">
            <div class="form-group">
                <label for="department_to">To Department (e.g., CS, Bio, All)</label>
                <input type="text" class="form-control" id="department_to" name="department_to" required
                    placeholder="Who is this for?">
            </div>
            <div class="form-group">
                <label for="content">Your Confession</label>
                <textarea class="form-control" id="content" name="content" rows="3" required
                    placeholder="Spill the tea..."></textarea>
            </div>
            <button type="submit" class="btn-primary">Post Anonymously</button>
        </form>
    </div>

    <!-- The Wall -->
    <div class="confession-wall">
        {% for confession in confessions %}
        <div class="confession-card">
            <h4>To: {{ confession.department_to }}</h4>
            <p>"{{ confession.content }}"</p>
            <div class="likes">
                <span>❤️ {{ confession.get_likes_count() }} likes</span>
                <span style="margin-left: auto; font-size: 0.7rem; color: #aaa;">{{
                    confession.created_at.strftime('%Y-%m-%d') }}</span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    // Rotated sticky note effect for confessions
    document.querySelectorAll('.confession-card').forEach(card => {
        const randomRotation = Math.random() * 6 - 3; // Random rotate between -3deg and 3deg
        card.style.setProperty('--rotation', randomRotation + 'deg');
    });
</script>
{% endblock %}